!function i(c,s,u){function a(t,e){if(!s[t]){if(!c[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var r=s[t]={exports:{}};c[t][0].call(r.exports,function(e){return a(c[t][1][e]||e)},r,r.exports,i,c,s,u)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,n){"use strict";var o=angular.module("stemApp",["ui.router"]);o.controller("BaseController",e("./controllers/BaseController")),o.provider("ApiRequest",e("./providers/ApiRequestProvider")),o.directive("popupModal",e("./directives/PopupModalDirective")),o.service("CredentialsService",e("./services/CredentialsService")),o.service("FormBuilderService",e("./services/FormBuilderService")),o.service("AuthService",e("./services/AuthService")),o.service("VoteService",e("./services/VoteService")),o.filter("strLimit",e("./filters/StrLimitFilter")),o.component("authComponent",e("./components/AuthComponent")),o.component("voteComponent",e("./components/VoteComponent")),o.config(e("./router/routes.js")),o.config(["ApiRequestProvider",function(e){e.setHost(env.apiUrl)}]),angular.bootstrap(document.getElementById("StemApp"),["stemApp"]),env.html5Mode.enable||document.location.hash||(document.location.hash="#!/")},{"./components/AuthComponent":2,"./components/VoteComponent":3,"./controllers/BaseController":4,"./directives/PopupModalDirective":5,"./filters/StrLimitFilter":6,"./providers/ApiRequestProvider":7,"./router/routes.js":8,"./services/AuthService":9,"./services/CredentialsService":10,"./services/FormBuilderService":11,"./services/VoteService":12}],2:[function(e,t,n){"use strict";t.exports={templateUrl:"./assets/templates/pages/auth.html",controller:["$rootScope","$scope","$state","$timeout","CredentialsService",function(e,t,n,o,r){var i=this;r.get()&&n.go("votes"),i.authorize=function(e){var t;"iOS"===device.platform?t="demomeapp://":"Android"===device.platform&&(t="io.forus.demo.meapp"),appAvailability.check(t,function(){window.open("demomeapp://auth?request=StemApp","_system")},function(){o(i.showInfo,0)})},i.showInfo=function(){e.modals.push({icon:["mdi-information-outline"],descLarge:"Om deze app te gebruiken heeft u de “me” app demo nodig.",type:"info",confirmText:"Ok",vibrate:0,confirm:function(){}})}}]}},{}],3:[function(e,t,n){"use strict";t.exports={templateUrl:"./assets/templates/pages/vote.html",controller:["$rootScope","$scope","$state","$stateParams","CredentialsService","VoteService",function(t,e,n,o,r,i){var c=this;i.active().then(function(e){c.vote=e.data},function(e){t.modals.push({icon:["danger"==e.data.type?"mdi-close-circle-outline":"alert-circle-outline"],title:e.data.title,desc:e.data.desc,type:e.data.type,confirm:function(){n.go("logout")}})}),c.submitVote=function(e){e&&i.vote(c.vote.id,e).then(function(e){t.modals.push({icon:["mdi-checkbox-multiple-marked-circle-outline"],title:"Success!",desc:"You have successfully voted.",type:"success",confirm:function(){n.go("logout")}})},function(e){t.modals.push({icon:["danger"==e.data.type?"mdi-close-circle-outline":"alert-circle-outline"],title:e.data.title,desc:e.data.desc,type:e.data.type,confirm:function(){n.go("logout")}})})}}]}},{}],4:[function(e,t,n){"use strict";t.exports=["$scope","$rootScope","$timeout","$state","CredentialsService",function(e,o,t,r,i){window.handleOpenURL=function(n){t(function(){var e=n.slice("demostemapp://".length),t=new URL("http://forus.io/"+e);t.searchParams.get("request");"/login"==t.pathname?(i.set(t.searchParams.get("accessToken")),r.go("vote")):"/login-declined"==t.pathname&&o.modals.push({icon:["mdi-close-circle-outline"],title:"Declined",desc:"Authorization declined!",type:"danger",confirm:function(){r.go("logout")}})},100)};var n=function e(){window.Connection&&navigator.connection.type==window.Connection.NONE&&o.modals.push({icon:["mdi-close-circle-outline"],title:"Error!",desc:"No internet connection!",type:"danger",confirmText:"Retry",confirm:function(){r.go("logout"),e()}})};t(function(){n(),document.addEventListener("offline",function(){t(n,0)},!1),document.addEventListener("online",function(){r.reload()},!1)},1e3),o.modals=new function(){var n=[];this.count=function(){return n.length},this.push=function(t){(void 0===t.vibrate||0<t.vibrate)&&(void 0===t.vibrate&&(t.vibrate=250),navigator.vibrate(t.vibrate)),t.close=function(e){e&&(e.stopPropagation(),e.preventDefault()),n.splice(n.indexOf(t),1)},n.push(t)},this.modals=function(){return n}}}]},{}],5:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"A",templateUrl:"./assets/templates/directives/popup-modal.html",replace:!0,transclude:!0,scope:{modal:"="},link:function(e,t,n,o){}}}]},{}],6:[function(e,t,n){"use strict";t.exports=function(){return function(e,t){var n="";return"string"!=typeof e?"":(e.length>t&&(n+="..."),e.substring(0,t)+n)}}},{}],7:[function(e,t,n){"use strict";t.exports=function(){return new function(){var l=!1;this.setHost=function(e){for(;"/"==e[e.length-1];)e=e.slice(0,e.length-1);l=e},this.$get=["$q","$http","$state","$rootScope","CredentialsService",function(c,s,u,e,a){var o=function(e,t,n,o,r){var i={};return i.data=n||{},i.headers=Object.assign(function(){a.get();return{Accept:"application/json","Content-Type":"application/json","Access-Token":a.get()}}(),o||{}),i.url=function(e){var t=document.createElement("a");t.href=e;var n=t.pathname.split("/");return""!==n[0]&&n.unshift(""),t.protocol+"//"+t.host+n.join("/")}(l+t),i.method=e,c(function(t,n){s(i).then(function(e){t(e)},function(e){401==e.status&&u.go("logout"),n(e)})})};return{get:function(e,t,n){return o("GET",e,t,n)},put:function(e,t,n){return o("PUT",e,t,n)},post:function(e,t,n){return o("POST",e,t,n)},delete:function(e,t,n){return o("DELETE",e,t,n)},ajax:o}}]}}},{}],8:[function(e,t,n){"use strict";t.exports=["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){e.state({url:"/logout",name:"logout",controller:["$state","$rootScope","CredentialsService",function(e,t,n){n.set(null),t.credentials=n.get(),e.go("auth")}]}).state({url:"/",name:"auth",component:"authComponent",data:{title:"Auth"}}).state({url:"/vote",name:"vote",component:"voteComponent",data:{title:"Vote"}})}]},{}],9:[function(e,t,n){"use strict";t.exports=["ApiRequest","CredentialsService",function(t,n){return new function(){this.signOut=function(e){n.set(null)},this.getUser=function(){return t.get("/user")},this.getVoucher=function(){return t.get("/user/voucher")},this.getQrCode=function(){return t.get("/user/voucher/qr-code")},this.getIntentCode=function(){return t.get("/auth/token")},this.getIntentCodeState=function(e){return t.post("/auth/token/check",{token:e})},this.intentToAccessToken=function(e){return t.post("/auth/token/exchange",{token:e})}}}]},{}],10:[function(e,t,n){"use strict";t.exports=[function(){return new function(){this.set=function(e){return localStorage.setItem("access_token",JSON.stringify(e))},this.get=function(){return JSON.parse(localStorage.getItem("access_token"))}}}]},{}],11:[function(e,t,n){"use strict";t.exports=["$http",function(e){return new function(){this.build=function(e,t){return{locked:!1,values:e||{},errors:t||{},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isLocked:function(){return this.locked},resetValues:function(){return this.values={}},resetErrors:function(){return this.errors={}},reset:function(){return this.resetValues()&this.resetErrors()}}}}}]},{}],12:[function(e,t,n){"use strict";t.exports=["ApiRequest",function(n){return new function(){this.active=function(e){return n.get("/votes/active")},this.vote=function(e,t){return n.post("/votes/"+e+"/vote",{vote_option_id:t})}}}]},{}],13:[function(e,t,n){},{}]},{},[13,1]);
//# sourceMappingURL=app.js.map
